

```{r, eval=F}
library(ape)
library(caper)
library(dplyr)
library(knitr)
library(kableExtra)

####################PGLS####################

PGLS_df <- data.frame(start = numeric(),
                 cov = character(),
                 cor = character(),
                 PGLs_p = numeric(),
                 PGLs_cor = numeric())

#Importing traits
TRAITS <- read.delim("/home/vincent/DTN/ancov/Traits.R.csv")
colnames(TRAITS)[1]="Id"

ID = TRAITS$Id

#Selecting traits
#TRAITS <- TRAITS %>% dplyr::select(c("GS","DNA","Helitron","LINE","LTR","na","others","rRNA","SINE", "short_SR", "TEs", "All"))
TRAITS <- TRAITS %>% dplyr::select(-c("Id"))
TRAITS[TRAITS == -1] <- NA

#for PGLS
tree <- read.tree("/home/vincent/DTN/Tree/root_droso_tree_MF")
tree$node.label <- NULL #VM

#
X_Names <- colnames(TRAITS)
Y_Names <- colnames(TRAITS)

for (X_Name in X_Names){
  
  Y_Names <- Y_Names[-1]
  
  for (Y_Name in Y_Names){

    X <- TRAITS[,colnames(TRAITS) %in% X_Name]
    Y <- TRAITS[,colnames(TRAITS) %in% Y_Name]
    
    data <- cbind(as.character(ID), log(X), log(Y))
    colnames(data) <- c("ID","Yaxis","Xaxis")
    data <- as.data.frame(data)
    
    data$Yaxis <- as.numeric(data$Yaxis)
    data$Xaxis <- as.numeric(data$Xaxis)
    
    pgls_data = comparative.data(
      tree,
      data, 
      ID, 
      vcv=TRUE)
    
    PGLS <- pgls(Yaxis ~ Xaxis,pgls_data)
    summary_PGLS <- summary(PGLS)
    
    COR <- paste(X_Name, Y_Name, sep=":")
    PGLs_P <- summary_PGLS$coefficients[2,4]
    PGLs_COR <- summary_PGLS$coefficients[2,1]
    tmp <- data.frame(start = -1.570796,
                      cov = X_Name,
                      cor = COR,
                      PGLs_p = PGLs_P,
                      PGLs_cor = PGLs_COR)
                      
    PGLS_df <- rbind(PGLS_df,tmp)
    

    
  }
}

PGLS_df$PGLs_p <- p.adjust(PGLS_df$PGLs_p, method="BH")

```
 